#!/usr/bin/env bash
set -euo pipefail

# TradeTracker scope guard â€“ dokumentÃ¡ciÃ³s Ã¡llapot validÃ¡lÃ¡sa.

ROOT_DIR="$(cd "$(dirname "$0")/../.." && pwd)"
DOC_PATH="${ROOT_DIR}/impactshop-notes/TradeTracker-integrÃ¡ciÃ³.md"
REPORT_DIR="${ROOT_DIR}/.codex/reports/tradetracker"
REPORT_FILE="${REPORT_DIR}/scope-overview.md"

mkdir -p "${REPORT_DIR}"

ts="$(date '+%Y-%m-%d %H:%M:%S')"

if [[ ! -f "${DOC_PATH}" ]]; then
  echo "âŒ HiÃ¡nyzÃ³ dokumentum: ${DOC_PATH}"
  exit 1
fi

echo "âœ… Dokumentum megtalÃ¡lva: ${DOC_PATH}"

cat >"${REPORT_FILE}" <<EOF
# TradeTracker scope overview
_Generated by tradetracker-scope-check.sh @ ${ts}_

- Source doc: impactshop-notes/TradeTracker-integrÃ¡ciÃ³.md
- Status   : Planning (no production impact)
- Next step: create scaffold under impact-bridge-tradetracker/ before implementation.

## Follow-up checklist
- [ ] KÃ¶nyvtÃ¡rstruktÃºra lÃ©trehozva a repo gyÃ¶kerÃ©ben
- [ ] KonfigurÃ¡ciÃ³s Ã©rtÃ©kek vaultban (TT_CUSTOMER_ID, TT_PASSPHRASE)
- [ ] Guardrail szkriptek ("scripts/diagnostics/tt_*.sh") megÃ­rva
- [ ] Impact router "/go" mÃ³dosÃ­tÃ¡s tervezet felÃ¼lvizsgÃ¡lva
- [ ] Tesztterv finomhangolva (unit + integration + smoke)
- [ ] Rollback folyamat szimulÃ¡lva (dry-run)

EOF

echo "ðŸ“„ Report frissÃ­tve: ${REPORT_FILE}"
